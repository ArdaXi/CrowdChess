!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).CrowdChess=e()}}(function(){return function e(t,r,n){function o(a,s){if(!r[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[a]={exports:{}};t[a][0].call(c.exports,function(e){var r=t[a][1][e];return o(r||e)},c,c.exports,e,t,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,r){function n(e){return Object.prototype.toString.call(e).slice(8,-1)}function o(e){var t=n(e);return-1!==["Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].indexOf(t)}t.exports=function(e,t){if(!o(e))throw new TypeError("Input should be Array or TypedArray");if("number"!=typeof t)throw new TypeError("Size should be a Number");for(var r=[],n=0;n<e.length;n+=t)"function"==typeof e.slice?r.push(e.slice(n,t+n)):r.push(e.subarray(n,t+n));return r}},{}],2:[function(e,t,r){var n=function(e){function t(){le=new Array(128),ue={w:R,b:R},ce=q,fe={w:0,b:0},de=R,pe=0,ve=1,he=[],ge={},s(i())}function r(){n(G)}function n(e){var r=e.split(/\s+/),n=r[0],a=0;if(!o(e).valid)return!1;t();for(var l=0;l<n.length;l++){var c=n.charAt(l);if("/"===c)a+=8;else if(N(c))a+=parseInt(c,10);else{var f=c<"a"?q:j;u({type:c.toLowerCase(),color:f},x(a)),a++}}return ce=r[1],r[2].indexOf("K")>-1&&(fe.w|=te.KSIDE_CASTLE),r[2].indexOf("Q")>-1&&(fe.w|=te.QSIDE_CASTLE),r[2].indexOf("k")>-1&&(fe.b|=te.KSIDE_CASTLE),r[2].indexOf("q")>-1&&(fe.b|=te.QSIDE_CASTLE),de="-"===r[3]?R:ae[r[3]],pe=parseInt(r[4],10),ve=parseInt(r[5],10),s(i()),!0}function o(e){var t={0:"No errors.",1:"FEN string must contain six space-delimited fields.",2:"6th field (move number) must be a positive integer.",3:"5th field (half move counter) must be a non-negative integer.",4:"4th field (en-passant square) is invalid.",5:"3rd field (castling availability) is invalid.",6:"2nd field (side to move) is invalid.",7:"1st field (piece positions) does not contain 8 '/'-delimited rows.",8:"1st field (piece positions) is invalid [consecutive numbers].",9:"1st field (piece positions) is invalid [invalid piece].",10:"1st field (piece positions) is invalid [row too large].",11:"Illegal en-passant square"},r=e.split(/\s+/);if(6!==r.length)return{valid:!1,error_number:1,error:t[1]};if(isNaN(r[5])||parseInt(r[5],10)<=0)return{valid:!1,error_number:2,error:t[2]};if(isNaN(r[4])||parseInt(r[4],10)<0)return{valid:!1,error_number:3,error:t[3]};if(!/^(-|[abcdefgh][36])$/.test(r[3]))return{valid:!1,error_number:4,error:t[4]};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(r[2]))return{valid:!1,error_number:5,error:t[5]};if(!/^(w|b)$/.test(r[1]))return{valid:!1,error_number:6,error:t[6]};var n=r[0].split("/");if(8!==n.length)return{valid:!1,error_number:7,error:t[7]};for(var o=0;o<n.length;o++){for(var i=0,a=!1,s=0;s<n[o].length;s++)if(isNaN(n[o][s])){if(!/^[prnbqkPRNBQK]$/.test(n[o][s]))return{valid:!1,error_number:9,error:t[9]};i+=1,a=!1}else{if(a)return{valid:!1,error_number:8,error:t[8]};i+=parseInt(n[o][s],10),a=!0}if(8!==i)return{valid:!1,error_number:10,error:t[10]}}return"3"==r[3][1]&&"w"==r[1]||"6"==r[3][1]&&"b"==r[1]?{valid:!1,error_number:11,error:t[11]}:{valid:!0,error_number:0,error:t[0]}}function i(){for(var e=0,t="",r=ae.a8;r<=ae.h1;r++){if(null==le[r])e++;else{e>0&&(t+=e,e=0);var n=le[r].color,o=le[r].type;t+=n===q?o.toUpperCase():o.toLowerCase()}r+1&136&&(e>0&&(t+=e),r!==ae.h1&&(t+="/"),e=0,r+=8)}var i="";fe[q]&te.KSIDE_CASTLE&&(i+="K"),fe[q]&te.QSIDE_CASTLE&&(i+="Q"),fe[j]&te.KSIDE_CASTLE&&(i+="k"),fe[j]&te.QSIDE_CASTLE&&(i+="q"),i=i||"-";var a=de===R?"-":x(de);return[t,ce,i,a,pe,ve].join(" ")}function a(e){for(var t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(ge[e[t]]=e[t+1]);return ge}function s(e){he.length>0||(e!==G?(ge.SetUp="1",ge.FEN=e):(delete ge.SetUp,delete ge.FEN))}function l(e){var t=le[ae[e]];return t?{type:t.type,color:t.color}:null}function u(e,t){if(!("type"in e&&"color"in e))return!1;if(-1===$.indexOf(e.type.toLowerCase()))return!1;if(!(t in ae))return!1;var r=ae[t];return(e.type!=X||ue[e.color]==R||ue[e.color]==r)&&(le[r]={type:e.type,color:e.color},e.type===X&&(ue[e.color]=r),s(i()),!0)}function c(e){var t=l(e);return le[ae[e]]=null,t&&t.type===X&&(ue[t.color]=R),s(i()),t}function f(e,t,r,n,o){var i={color:ce,from:t,to:r,flags:n,piece:e[t].type};return o&&(i.flags|=te.PROMOTION,i.promotion=o),e[r]?i.captured=e[r].type:n&te.EP_CAPTURE&&(i.captured=U),i}function d(e){function t(e,t,r,n,o){if(e[r].type!==U||S(n)!==ie&&S(n)!==re)t.push(f(e,r,n,o));else for(var i=[F,W,Q,B],a=0,s=i.length;a<s;a++)t.push(f(e,r,n,o,i[a]))}var r=[],n=ce,o=M(n),i={b:oe,w:ne},a=ae.a8,s=ae.h1,l=!1,u=!(void 0!==e&&"legal"in e)||e.legal;if(void 0!==e&&"square"in e){if(!(e.square in ae))return[];a=s=ae[e.square],l=!0}for(k=a;k<=s;k++)if(136&k)k+=7;else{var c=le[k];if(null!=c&&c.color===n)if(c.type===U){m=k+H[n][0];if(null==le[m]){t(le,r,k,m,te.NORMAL);m=k+H[n][1];i[n]===S(k)&&null==le[m]&&t(le,r,k,m,te.BIG_PAWN)}for(d=2;d<4;d++)136&(m=k+H[n][d])||(null!=le[m]&&le[m].color===o?t(le,r,k,m,te.CAPTURE):m===de&&t(le,r,k,de,te.EP_CAPTURE))}else for(var d=0,p=Z[c.type].length;d<p;d++)for(var v=Z[c.type][d],m=k;;){if(136&(m+=v))break;if(null!=le[m]){if(le[m].color===n)break;t(le,r,k,m,te.CAPTURE);break}if(t(le,r,k,m,te.NORMAL),"n"===c.type||"k"===c.type)break}}if(!l||s===ue[n]){if(fe[n]&te.KSIDE_CASTLE){y=(b=ue[n])+2;null!=le[b+1]||null!=le[y]||h(o,ue[n])||h(o,b+1)||h(o,y)||t(le,r,ue[n],y,te.KSIDE_CASTLE)}if(fe[n]&te.QSIDE_CASTLE){var b=ue[n],y=b-2;null!=le[b-1]||null!=le[b-2]||null!=le[b-3]||h(o,ue[n])||h(o,b-1)||h(o,y)||t(le,r,ue[n],y,te.QSIDE_CASTLE)}}if(!u)return r;for(var w=[],k=0,p=r.length;k<p;k++)E(r[k]),g(n)||w.push(r[k]),C();return w}function p(e,t){var r="";if(e.flags&te.KSIDE_CASTLE)r="O-O";else if(e.flags&te.QSIDE_CASTLE)r="O-O-O";else{var n=_(e,t);e.piece!==U&&(r+=e.piece.toUpperCase()+n),e.flags&(te.CAPTURE|te.EP_CAPTURE)&&(e.piece===U&&(r+=x(e.from)[0]),r+="x"),r+=x(e.to),e.flags&te.PROMOTION&&(r+="="+e.promotion.toUpperCase())}return E(e),m()&&(b()?r+="#":r+="+"),C(),r}function v(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function h(e,t){for(var r=ae.a8;r<=ae.h1;r++)if(136&r)r+=7;else if(null!=le[r]&&le[r].color===e){var n=le[r],o=r-t,i=o+119;if(Y[i]&1<<J[n.type]){if(n.type===U){if(o>0){if(n.color===q)return!0}else if(n.color===j)return!0;continue}if("n"===n.type||"k"===n.type)return!0;for(var a=V[i],s=r+a,l=!1;s!==t;){if(null!=le[s]){l=!0;break}s+=a}if(!l)return!0}}return!1}function g(e){return h(M(e),ue[e])}function m(){return g(ce)}function b(){return m()&&0===d().length}function y(){return!m()&&0===d().length}function w(){for(var e={},t=[],r=0,n=0,o=ae.a8;o<=ae.h1;o++)if(n=(n+1)%2,136&o)o+=7;else{var i=le[o];i&&(e[i.type]=i.type in e?e[i.type]+1:1,i.type===Q&&t.push(n),r++)}if(2===r)return!0;if(3===r&&(1===e[Q]||1===e[B]))return!0;if(r===e[Q]+2){for(var a=0,s=t.length,o=0;o<s;o++)a+=t[o];if(0===a||a===s)return!0}return!1}function k(){for(var e=[],t={},r=!1;;){var n=C();if(!n)break;e.push(n)}for(;;){var o=i().split(" ").slice(0,4).join(" ");if(t[o]=o in t?t[o]+1:1,t[o]>=3&&(r=!0),!e.length)break;E(e.pop())}return r}function P(e){he.push({move:e,kings:{b:ue.b,w:ue.w},turn:ce,castling:{b:fe.b,w:fe.w},ep_square:de,half_moves:pe,move_number:ve})}function E(e){var t=ce,r=M(t);if(P(e),le[e.to]=le[e.from],le[e.from]=null,e.flags&te.EP_CAPTURE&&(ce===j?le[e.to-16]=null:le[e.to+16]=null),e.flags&te.PROMOTION&&(le[e.to]={type:e.promotion,color:t}),le[e.to].type===X){if(ue[le[e.to].color]=e.to,e.flags&te.KSIDE_CASTLE){var n=e.to-1,o=e.to+1;le[n]=le[o],le[o]=null}else if(e.flags&te.QSIDE_CASTLE){var n=e.to+1,o=e.to-2;le[n]=le[o],le[o]=null}fe[t]=""}if(fe[t])for(var i=0,a=se[t].length;i<a;i++)if(e.from===se[t][i].square&&fe[t]&se[t][i].flag){fe[t]^=se[t][i].flag;break}if(fe[r])for(var i=0,a=se[r].length;i<a;i++)if(e.to===se[r][i].square&&fe[r]&se[r][i].flag){fe[r]^=se[r][i].flag;break}de=e.flags&te.BIG_PAWN?"b"===ce?e.to-16:e.to+16:R,e.piece===U?pe=0:e.flags&(te.CAPTURE|te.EP_CAPTURE)?pe=0:pe++,ce===j&&ve++,ce=M(ce)}function C(){var e=he.pop();if(null==e)return null;var t=e.move;ue=e.kings,ce=e.turn,fe=e.castling,de=e.ep_square,pe=e.half_moves,ve=e.move_number;var r=ce,n=M(ce);if(le[t.from]=le[t.to],le[t.from].type=t.piece,le[t.to]=null,t.flags&te.CAPTURE)le[t.to]={type:t.captured,color:n};else if(t.flags&te.EP_CAPTURE){var o;o=r===j?t.to-16:t.to+16,le[o]={type:U,color:n}}if(t.flags&(te.KSIDE_CASTLE|te.QSIDE_CASTLE)){var i,a;t.flags&te.KSIDE_CASTLE?(i=t.to+1,a=t.to-1):t.flags&te.QSIDE_CASTLE&&(i=t.to-2,a=t.to+1),le[i]=le[a],le[a]=null}return t}function _(e,t){for(var r=d({legal:!t}),n=e.from,o=e.to,i=e.piece,a=0,s=0,l=0,u=0,c=r.length;u<c;u++){var f=r[u].from,p=r[u].to;i===r[u].piece&&n!==f&&o===p&&(a++,S(n)===S(f)&&s++,T(n)===T(f)&&l++)}return a>0?s>0&&l>0?x(n):l>0?x(n).charAt(1):x(n).charAt(0):""}function A(){for(var e="   +------------------------+\n",t=ae.a8;t<=ae.h1;t++){if(0===T(t)&&(e+=" "+"87654321"[S(t)]+" |"),null==le[t])e+=" . ";else{var r=le[t].type;e+=" "+(le[t].color===q?r.toUpperCase():r.toLowerCase())+" "}t+1&136&&(e+="|\n",t+=8)}return e+="   +------------------------+\n",e+="     a  b  c  d  e  f  g  h\n"}function O(e,t){var r=v(e);if(t){var n=r.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(n)var o=n[1],i=n[2],a=n[3],s=n[4]}for(var l=d(),u=0,c=l.length;u<c;u++){if(r===v(p(l[u]))||t&&r===v(p(l[u],!0)))return l[u];if(n&&(!o||o.toLowerCase()==l[u].piece)&&ae[i]==l[u].from&&ae[a]==l[u].to&&(!s||s.toLowerCase()==l[u].promotion))return l[u]}return null}function S(e){return e>>4}function T(e){return 15&e}function x(e){var t=T(e),r=S(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(r,r+1)}function M(e){return e===q?j:q}function N(e){return-1!=="0123456789".indexOf(e)}function L(e){var t=D(e);t.san=p(t,!1),t.to=x(t.to),t.from=x(t.from);var r="";for(var n in te)te[n]&t.flags&&(r+=ee[n]);return t.flags=r,t}function D(e){var t=e instanceof Array?[]:{};for(var r in e)t[r]="object"==typeof r?D(e[r]):e[r];return t}function I(e){return e.replace(/^\s+|\s+$/g,"")}function K(e){for(var t=d({legal:!1}),r=0,n=ce,o=0,i=t.length;o<i;o++)E(t[o]),g(n)||(e-1>0?r+=K(e-1):r++),C();return r}var j="b",q="w",R=-1,U="p",B="n",Q="b",W="r",F="q",X="k",$="pnbrqkPNBRQK",G="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",z=["1-0","0-1","1/2-1/2","*"],H={b:[16,32,17,15],w:[-16,-32,-17,-15]},Z={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},Y=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],V=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],J={p:0,n:1,b:2,r:3,q:4,k:5},ee={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},te={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},re=7,ne=6,oe=1,ie=0,ae={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},se={w:[{square:ae.a1,flag:te.QSIDE_CASTLE},{square:ae.h1,flag:te.KSIDE_CASTLE}],b:[{square:ae.a8,flag:te.QSIDE_CASTLE},{square:ae.h8,flag:te.KSIDE_CASTLE}]},le=new Array(128),ue={w:R,b:R},ce=q,fe={w:0,b:0},de=R,pe=0,ve=1,he=[],ge={};return n(void 0===e?G:e),{WHITE:q,BLACK:j,PAWN:U,KNIGHT:B,BISHOP:Q,ROOK:W,QUEEN:F,KING:X,SQUARES:function(){for(var e=[],t=ae.a8;t<=ae.h1;t++)136&t?t+=7:e.push(x(t));return e}(),FLAGS:ee,load:function(e){return n(e)},reset:function(){return r()},moves:function(e){for(var t=d(e),r=[],n=0,o=t.length;n<o;n++)void 0!==e&&"verbose"in e&&e.verbose?r.push(L(t[n])):r.push(p(t[n],!1));return r},in_check:function(){return m()},in_checkmate:function(){return b()},in_stalemate:function(){return y()},in_draw:function(){return pe>=100||y()||w()||k()},insufficient_material:function(){return w()},in_threefold_repetition:function(){return k()},game_over:function(){return pe>=100||b()||y()||w()||k()},validate_fen:function(e){return o(e)},fen:function(){return i()},pgn:function(e){var t="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",r="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,n=[],o=!1;for(var i in ge)n.push("["+i+' "'+ge[i]+'"]'+t),o=!0;o&&he.length&&n.push(t);for(var a=[];he.length>0;)a.push(C());for(var s=[],l="";a.length>0;){var u=a.pop();he.length||"b"!==u.color?"w"===u.color&&(l.length&&s.push(l),l=ve+"."):l=ve+". ...",l=l+" "+p(u,!1),E(u)}if(l.length&&s.push(l),void 0!==ge.Result&&s.push(ge.Result),0===r)return n.join("")+s.join(" ");for(var c=0,i=0;i<s.length;i++)c+s[i].length>r&&0!==i?(" "===n[n.length-1]&&n.pop(),n.push(t),c=0):0!==i&&(n.push(" "),c++),n.push(s[i]),c+=s[i].length;return n.join("")},load_pgn:function(e,t){function o(e){return e.replace(/\\/g,"\\")}var i=void 0!==t&&"sloppy"in t&&t.sloppy,s="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",l=new RegExp("^(\\[(.|"+o(s)+")*\\])("+o(s)+")*1.("+o(s)+"|.)*$","g"),u=e.replace(l,"$1");"["!==u[0]&&(u=""),r();var c=function(e,t){for(var r="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",n={},i=e.split(new RegExp(o(r))),a="",s="",l=0;l<i.length;l++)a=i[l].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),s=i[l].replace(/^\[[A-Za-z]+\s"(.*)"\]$/,"$1"),I(a).length>0&&(n[a]=s);return n}(u,t);for(var f in c)a([f,c[f]]);if("1"===c.SetUp&&!("FEN"in c&&n(c.FEN)))return!1;var d=e.replace(u,"").replace(new RegExp(o(s),"g")," ");d=d.replace(/(\{[^}]+\})+?/g,"");for(var p=/(\([^\(\)]+\))+?/g;p.test(d);)d=d.replace(p,"");var v=I(d=(d=(d=d.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));v=v.join(",").replace(/,,+/g,",").split(",");for(var h="",g=0;g<v.length-1;g++){if(null==(h=O(v[g],i)))return!1;E(h)}if(h=v[v.length-1],z.indexOf(h)>-1)(function(e){for(var t in e)return!0;return!1})(ge)&&void 0===ge.Result&&a(["Result",h]);else{if(null==(h=O(h,i)))return!1;E(h)}return!0},header:function(){return a(arguments)},ascii:function(){return A()},turn:function(){return ce},move:function(e,t){var r=void 0!==t&&"sloppy"in t&&t.sloppy,n=null;if("string"==typeof e)n=O(e,r);else if("object"==typeof e)for(var o=d(),i=0,a=o.length;i<a;i++)if(!(e.from!==x(o[i].from)||e.to!==x(o[i].to)||"promotion"in o[i]&&e.promotion!==o[i].promotion)){n=o[i];break}if(!n)return null;var s=L(n);return E(n),s},undo:function(){var e=C();return e?L(e):null},clear:function(){return t()},put:function(e,t){return u(e,t)},get:function(e){return l(e)},remove:function(e){return c(e)},perft:function(e){return K(e)},square_color:function(e){if(e in ae){var t=ae[e];return(S(t)+T(t))%2==0?"light":"dark"}return null},history:function(e){for(var t=[],r=[],n=(void 0!==e&&"verbose"in e&&e.verbose);he.length>0;)t.push(C());for(;t.length>0;){var o=t.pop();n?r.push(L(o)):r.push(p(o)),E(o)}return r}}};void 0!==r&&(r.Chess=n)},{}],3:[function(e,t,r){"use strict";function n(e,t){var r=e(t);return t.dom.redraw(),r}function o(e,t){return{key:e,pos:p.key2pos(e),piece:t}}function i(e,t){return t.sort(function(t,r){return p.distanceSq(e.pos,t.pos)-p.distanceSq(e.pos,r.pos)})[0]}function a(e,t){var r,n,a,s,l,u,c=t.dom.bounds(),f=c.width/8,d=c.height/8,v={},h=[],g={},m=[],b=[],y={},w="white"===t.orientation;for(a in e)y[a]=o(a,e[a]);for(var k=0,P=p.allKeys;k<P.length;k++){var E=P[k];r=t.pieces[E],n=y[E],r?n?p.samePiece(r,n.piece)||(m.push(n),b.push(o(E,r))):b.push(o(E,r)):n&&m.push(n)}return b.forEach(function(e){(n=i(e,m.filter(function(t){return p.samePiece(e.piece,t.piece)})))&&(s=w?n.pos:e.pos,l=w?e.pos:n.pos,u=[(s[0]-l[0])*f,(l[1]-s[1])*d],v[e.key]=[u,u],h.push(n.key))}),m.forEach(function(e){p.containsX(h,e.key)||t.items&&t.items(e.pos,e.key)||(g[e.key]=e.piece)}),{anims:v,fadings:g}}function s(e){var t=e.animation.current;if(t){var r=1-(Date.now()-t.start)/t.duration;if(r<=0)e.animation.current=void 0,e.dom.redrawNow();else{var n=c(r);for(var o in t.plan.anims){var i=t.plan.anims[o];i[1]=[f(i[0][0]*n,10),f(i[0][1]*n,10)]}e.dom.redrawNow(!0),p.raf(function(){return s(e)})}}else e.dom.destroyed||e.dom.redrawNow()}function l(e,t){var r=d({},t.pieces),n=e(t),o=a(r,t);if(u(o.anims)&&u(o.fadings))t.dom.redraw();else{var i=t.animation.current&&t.animation.current.start;t.animation.current={start:Date.now(),duration:t.animation.duration,plan:o},i||s(t)}return n}function u(e){for(var t in e)return!1;return!0}function c(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1}function f(e,t){return Math.round(e*t)/t}var d=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};Object.defineProperty(r,"__esModule",{value:!0});var p=e("./util");r.anim=function(e,t){return t.animation.enabled?l(e,t):n(e,t)},r.render=n},{"./util":18}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./board"),o=e("./fen"),i=e("./config"),a=e("./anim"),s=e("./drag"),l=e("./explosion");r.start=function(e,t){function r(){n.toggleOrientation(e),t()}return{set:function(t){t.orientation&&t.orientation!==e.orientation&&r(),(t.fen?a.anim:a.render)(function(e){return i.configure(e,t)},e)},state:e,getFen:function(){return o.write(e.pieces)},toggleOrientation:r,setPieces:function(t){a.anim(function(e){return n.setPieces(e,t)},e)},selectSquare:function(t,r){t?a.anim(function(e){return n.selectSquare(e,t,r)},e):e.selected&&(n.unselect(e),e.dom.redraw())},move:function(t,r){a.anim(function(e){return n.baseMove(e,t,r)},e)},newPiece:function(t,r){a.anim(function(e){return n.baseNewPiece(e,t,r)},e)},playPremove:function(){if(e.premovable.current){if(a.anim(n.playPremove,e))return!0;e.dom.redraw()}return!1},playPredrop:function(t){if(e.predroppable.current){var r=n.playPredrop(e,t);return e.dom.redraw(),r}return!1},cancelPremove:function(){a.render(n.unsetPremove,e)},cancelPredrop:function(){a.render(n.unsetPredrop,e)},cancelMove:function(){a.render(function(e){n.cancelMove(e),s.cancel(e)},e)},stop:function(){a.render(function(e){n.stop(e),s.cancel(e)},e)},explode:function(t){l.default(e,t)},setAutoShapes:function(t){a.render(function(e){return e.drawable.autoShapes=t},e)},setShapes:function(t){a.render(function(e){return e.drawable.shapes=t},e)},getKeyAtDomPos:function(t){return n.getKeyAtDomPos(t,"white"===e.orientation,e.dom.bounds())},redrawAll:t,dragNewPiece:function(t,r,n){s.dragNewPiece(e,t,r,n)},destroy:function(){n.stop(e),e.dom.unbind&&e.dom.unbind(),e.dom.destroyed=!0}}}},{"./anim":3,"./board":5,"./config":7,"./drag":8,"./explosion":11,"./fen":12}],5:[function(e,t,r){"use strict";function n(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];e&&setTimeout(function(){return e.apply(void 0,t)},1)}function o(e,t,r,o){s(e),e.premovable.current=[t,r],n(e.premovable.events.set,t,r,o)}function i(e){e.premovable.current&&(e.premovable.current=void 0,n(e.premovable.events.unset))}function a(e,t,r){i(e),e.predroppable.current={role:t,key:r},n(e.predroppable.events.set,t,r)}function s(e){var t=e.predroppable;t.current&&(t.current=void 0,n(t.events.unset))}function l(e,t,r){if(!e.autoCastle)return!1;var n=e.pieces[t];if("king"!==n.role)return!1;var o=P.key2pos(t);if(5!==o[0])return!1;if(1!==o[1]&&8!==o[1])return!1;var i,a,s,l=P.key2pos(r);if(7===l[0]||8===l[0])i=P.pos2key([8,o[1]]),a=P.pos2key([6,o[1]]),s=P.pos2key([7,o[1]]);else{if(3!==l[0]&&1!==l[0])return!1;i=P.pos2key([1,o[1]]),a=P.pos2key([4,o[1]]),s=P.pos2key([3,o[1]])}var u=e.pieces[i];return"rook"===u.role&&(delete e.pieces[t],delete e.pieces[i],e.pieces[s]=n,e.pieces[a]=u,!0)}function u(e,t,r){if(t===r||!e.pieces[t])return!1;var o=e.pieces[r]&&e.pieces[r].color!==e.pieces[t].color?e.pieces[r]:void 0;return r==e.selected&&v(e),n(e.events.move,t,r,o),l(e,t,r)||(e.pieces[r]=e.pieces[t],delete e.pieces[t]),e.lastMove=[t,r],e.check=void 0,n(e.events.change),o||!0}function c(e,t,r,o){if(e.pieces[r]){if(!o)return!1;delete e.pieces[r]}return n(e.events.dropNewPiece,t,r),e.pieces[r]=t,e.lastMove=[r],e.check=void 0,n(e.events.change),e.movable.dests=void 0,e.turnColor=P.opposite(e.turnColor),!0}function f(e,t,r){var n=u(e,t,r);return n&&(e.movable.dests=void 0,e.turnColor=P.opposite(e.turnColor),e.animation.current=void 0),n}function d(e,t,r){if(g(e,t,r)){var i=f(e,t,r);if(i){var a=e.hold.stop();v(e);var s={premove:!1,ctrlKey:e.stats.ctrlKey,holdTime:a};return!0!==i&&(s.captured=i),n(e.movable.events.after,t,r,s),!0}}else y(e,t,r)?(o(e,t,r,{ctrlKey:e.stats.ctrlKey}),v(e)):h(e,r)||b(e,r)?(p(e,r),e.hold.start()):v(e);return!1}function p(e,t){e.selected=t,b(e,t)?e.premovable.dests=E.default(e.pieces,t,e.premovable.castle):e.premovable.dests=void 0}function v(e){e.selected=void 0,e.premovable.dests=void 0,e.hold.cancel()}function h(e,t){var r=e.pieces[t];return r&&("both"===e.movable.color||e.movable.color===r.color&&e.turnColor===r.color)}function g(e,t,r){return t!==r&&h(e,t)&&(e.movable.free||!!e.movable.dests&&P.containsX(e.movable.dests[t],r))}function m(e,t,r){var n=e.pieces[t];return n&&r&&(t===r||!e.pieces[r])&&("both"===e.movable.color||e.movable.color===n.color&&e.turnColor===n.color)}function b(e,t){var r=e.pieces[t];return r&&e.premovable.enabled&&e.movable.color===r.color&&e.turnColor!==r.color}function y(e,t,r){return t!==r&&b(e,t)&&P.containsX(E.default(e.pieces,t,e.premovable.castle),r)}function w(e,t,r){var n=e.pieces[t];return n&&r&&(!e.pieces[r]||e.pieces[r].color!==e.movable.color)&&e.predroppable.enabled&&("pawn"!==n.role||"1"!==r[1]&&"8"!==r[1])&&e.movable.color===n.color&&e.turnColor!==n.color}function k(e){i(e),s(e),v(e)}Object.defineProperty(r,"__esModule",{value:!0});var P=e("./util"),E=e("./premove");r.callUserFunction=n,r.toggleOrientation=function(e){e.orientation=P.opposite(e.orientation),e.animation.current=e.draggable.current=e.selected=void 0},r.reset=function(e){e.lastMove=void 0,v(e),i(e),s(e)},r.setPieces=function(e,t){for(var r in t){var n=t[r];n?e.pieces[r]=n:delete e.pieces[r]}},r.setCheck=function(e,t){if(!0===t&&(t=e.turnColor),t)for(var r in e.pieces)"king"===e.pieces[r].role&&e.pieces[r].color===t&&(e.check=r);else e.check=void 0},r.unsetPremove=i,r.unsetPredrop=s,r.baseMove=u,r.baseNewPiece=c,r.userMove=d,r.dropNewPiece=function(e,t,r,o){if(m(e,t,r)||o){var l=e.pieces[t];delete e.pieces[t],c(e,l,r,o),n(e.movable.events.afterNewPiece,l.role,r,{predrop:!1})}else w(e,t,r)?a(e,e.pieces[t].role,r):(i(e),s(e));delete e.pieces[t],v(e)},r.selectSquare=function(e,t,r){e.selected?e.selected!==t||e.draggable.enabled?(e.selectable.enabled||r)&&e.selected!==t?d(e,e.selected,t)&&(e.stats.dragged=!1):e.hold.start():(v(e),e.hold.cancel()):(h(e,t)||b(e,t))&&(p(e,t),e.hold.start()),n(e.events.select,t)},r.setSelected=p,r.unselect=v,r.canMove=g,r.isDraggable=function(e,t){var r=e.pieces[t];return r&&e.draggable.enabled&&("both"===e.movable.color||e.movable.color===r.color&&(e.turnColor===r.color||e.premovable.enabled))},r.playPremove=function(e){var t=e.premovable.current;if(!t)return!1;var r=t[0],o=t[1],a=!1;if(g(e,r,o)){var s=f(e,r,o);if(s){var l={premove:!0};!0!==s&&(l.captured=s),n(e.movable.events.after,r,o,l),a=!0}}return i(e),a},r.playPredrop=function(e,t){var r=e.predroppable.current,o=!1;return!!r&&(t(r)&&c(e,{role:r.role,color:e.movable.color},r.key)&&(n(e.movable.events.afterNewPiece,r.role,r.key,{predrop:!0}),o=!0),s(e),o)},r.cancelMove=k,r.stop=function(e){e.movable.color=e.movable.dests=e.animation.current=void 0,k(e)},r.getKeyAtDomPos=function(e,t,r){var n=Math.ceil((e[0]-r.left)/r.width*8);t||(n=9-n);var o=Math.ceil(8-(e[1]-r.top)/r.height*8);return t||(o=9-o),n>0&&n<9&&o>0&&o<9?P.pos2key([n,o]):void 0}},{"./premove":13,"./util":18}],6:[function(e,t,r){"use strict";function n(e){var t=!1;return function(){t||(t=!0,f.raf(function(){e(),t=!1}))}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./api"),i=e("./config"),a=e("./state"),s=e("./wrap"),l=e("./events"),u=e("./render"),c=e("./svg"),f=e("./util");r.Chessground=function(e,t){function r(){var t=d.dom&&d.dom.unbind;e.classList.add("cg-board-wrap");var o=f.memo(function(){return e.getBoundingClientRect()}),i=s.default(e,d,o()),a=function(e){u.default(d),!e&&i.svg&&c.renderSvg(d,i.svg)};d.dom={elements:i,bounds:o,redraw:n(a),redrawNow:a,unbind:t},c.clearCache(),a(!1),l.bindBoard(d),t||(d.dom.unbind=l.bindDocument(d,r))}var d=a.defaults();return i.configure(d,t||{}),r(),o.start(d,r)}},{"./api":4,"./config":7,"./events":10,"./render":14,"./state":15,"./svg":16,"./util":18,"./wrap":19}],7:[function(e,t,r){"use strict";function n(e,t){for(var r in t)o(e[r])&&o(t[r])?n(e[r],t[r]):e[r]=t[r]}function o(e){return"object"==typeof e}Object.defineProperty(r,"__esModule",{value:!0});var i=e("./board"),a=e("./fen");r.configure=function(e,t){if(t.movable&&t.movable.dests&&(e.movable.dests=void 0),n(e,t),t.fen&&(e.pieces=a.read(t.fen),e.drawable.shapes=[]),t.hasOwnProperty("check")&&i.setCheck(e,t.check||!1),t.hasOwnProperty("lastMove")&&!t.lastMove?e.lastMove=void 0:t.lastMove&&(e.lastMove=t.lastMove),e.selected&&i.setSelected(e,e.selected),(!e.animation.duration||e.animation.duration<100)&&(e.animation.enabled=!1),!e.movable.rookCastle&&e.movable.dests){var r="white"===e.movable.color?1:8,o="e"+r,s=e.movable.dests[o];if(!s||"king"!==e.pieces[o].role)return;e.movable.dests[o]=s.filter(function(e){return!(e==="a"+r&&-1!==s.indexOf("c"+r)||e==="h"+r&&-1!==s.indexOf("g"+r))})}}},{"./board":5,"./fen":12}],8:[function(e,t,r){"use strict";function n(e){u.raf(function(){var t=e.draggable.current;if(t){e.animation.current&&e.animation.current.plan.anims[t.orig]&&(e.animation.current=void 0);var r=e.pieces[t.orig];if(r&&u.samePiece(r,t.piece)){if(!t.started&&u.distanceSq(t.epos,t.rel)>=Math.pow(e.draggable.distance,2)&&(t.started=!0),t.started){if("function"==typeof t.element){var i=t.element();if(!i)return;t.element=i,t.element.cgDragging=!0,t.element.classList.add("dragging")}var a="white"===e.orientation,s=e.dom.bounds();t.pos=[t.epos[0]-t.rel[0],t.epos[1]-t.rel[1]],t.over=l.getKeyAtDomPos(t.epos,a,s);var c=u.posToTranslate(t.origPos,a,s);c[0]+=t.pos[0]+t.dec[0],c[1]+=t.pos[1]+t.dec[1],t.element.style.transform=u.translate(c);var f=e.dom.elements.over;if(f&&t.over&&t.over!==t.overPrev){var d=e.movable.dests;if(e.movable.free||u.containsX(d&&d[t.orig],t.over)||u.containsX(e.premovable.dests,t.over)){var p=u.key2pos(t.over),v=[(a?p[0]-1:8-p[0])*s.width/8,(a?8-p[1]:p[1]-1)*s.height/8];f.style.transform=u.translate(v)}else f.style.transform=u.translateAway;t.overPrev=t.over}}}else o(e);n(e)}})}function o(e){var t=e.draggable.current;t&&(t.newPiece&&delete e.pieces[t.orig],e.draggable.current=void 0,l.unselect(e),i(e),e.dom.redraw())}function i(e){var t=e.dom.elements;t.over&&(t.over.style.transform=u.translateAway),t.ghost&&(t.ghost.style.transform=u.translateAway)}function a(e,t,r){var n=u.key2pos(e);return t||(n[0]=9-n[0],n[1]=9-n[1]),{left:r.left+r.width*(n[0]-1)/8,top:r.top+r.height*(8-n[1])/8,width:r.width/8,height:r.height/8}}function s(e,t){for(var r=e.dom.elements.board.firstChild;r;){if(r.cgKey===t&&"PIECE"===r.tagName)return r;r=r.nextSibling}}Object.defineProperty(r,"__esModule",{value:!0});var l=e("./board"),u=e("./util"),c=e("./draw"),f=e("./anim");r.start=function(e,t){if(!(void 0!==t.button&&0!==t.button||t.touches&&t.touches.length>1)){t.preventDefault();var r="white"===e.orientation,o=e.dom.bounds(),i=u.eventPosition(t),d=l.getKeyAtDomPos(i,r,o);if(d){var p=e.pieces[d],v=e.selected;if(v||!e.drawable.eraseOnClick&&p&&p.color===e.turnColor||c.clear(e),!e.viewOnly){var h=!!e.premovable.current,g=!!e.predroppable.current;e.stats.ctrlKey=t.ctrlKey,e.selected&&l.canMove(e,e.selected,d)?f.anim(function(e){return l.selectSquare(e,d)},e):l.selectSquare(e,d);var m=e.selected===d,b=s(e,d);if(p&&b&&m&&l.isDraggable(e,d)){var y=a(d,r,o);e.draggable.current={orig:d,origPos:u.key2pos(d),piece:p,rel:i,epos:i,pos:[0,0],dec:e.draggable.centerPiece?[i[0]-(y.left+y.width/2),i[1]-(y.top+y.height/2)]:[0,0],started:e.draggable.autoDistance&&e.stats.dragged,element:b,previouslySelected:v,originTarget:t.target},b.cgDragging=!0,b.classList.add("dragging");var w=e.dom.elements.ghost;w&&(w.className="ghost "+p.color+" "+p.role,w.style.transform=u.translate(u.posToTranslate(u.key2pos(d),r,o))),n(e)}else h&&l.unsetPremove(e),g&&l.unsetPredrop(e);e.dom.redraw()}}}},r.dragNewPiece=function(e,t,r,o){e.pieces.a0=t,e.dom.redraw();var i=u.eventPosition(r),l="white"===e.orientation,c=e.dom.bounds(),f=a("a0",l,c),d=[(l?0:7)*f.width+c.left,(l?8:-1)*f.height+c.top];e.draggable.current={orig:"a0",origPos:u.key2pos("a0"),piece:t,rel:d,epos:i,pos:[i[0]-d[0],i[1]-d[1]],dec:[-f.width/2,-f.height/2],started:!0,element:function(){return s(e,"a0")},originTarget:r.target,newPiece:!0,force:o||!1},n(e)},r.move=function(e,t){e.draggable.current&&(!t.touches||t.touches.length<2)&&(e.draggable.current.epos=u.eventPosition(t))},r.end=function(e,t){var r=e.draggable.current;if(r)if("touchend"!==t.type||!r||r.originTarget===t.target||r.newPiece){l.unsetPremove(e),l.unsetPredrop(e);var n=u.eventPosition(t)||r.epos,o=l.getKeyAtDomPos(n,"white"===e.orientation,e.dom.bounds());o&&r.started?r.newPiece?l.dropNewPiece(e,r.orig,o,r.force):(e.stats.ctrlKey=t.ctrlKey,l.userMove(e,r.orig,o)&&(e.stats.dragged=!0)):r.newPiece?delete e.pieces[r.orig]:e.draggable.deleteOnDropOff&&(delete e.pieces[r.orig],l.callUserFunction(e.events.change)),!r||r.orig!==r.previouslySelected||r.orig!==o&&o?e.selectable.enabled||l.unselect(e):l.unselect(e),i(e),e.draggable.current=void 0,e.dom.redraw()}else e.draggable.current=void 0},r.cancel=o},{"./anim":3,"./board":5,"./draw":9,"./util":18}],9:[function(e,t,r){"use strict";function n(e){f.raf(function(){var t=e.drawable.current;if(t){var r=c.getKeyAtDomPos(t.pos,"white"===e.orientation,e.dom.bounds()),o=t.orig===r?void 0:r;o!==t.dest&&(t.dest=o,e.dom.redrawNow()),n(e)}})}function o(e){e.drawable.current&&(e.drawable.current=void 0,e.dom.redraw())}function i(e){var t=e.shiftKey&&f.isRightButton(e)?1:0,r=e.altKey?2:0;return d[t+r]}function a(e){return function(t){return!e(t)}}function s(e,t){var r=t.orig,n=function(e){return e.orig===r&&!e.dest},o=e.shapes.filter(n)[0];o&&(e.shapes=e.shapes.filter(a(n))),o&&o.brush===t.brush||e.shapes.push({brush:t.brush,orig:r}),u(e)}function l(e,t,r){var n=t.orig,o=function(e){return!!e.dest&&(e.orig===n&&e.dest===r||e.dest===n&&e.orig===r)};e.shapes.filter(o).length>0?e.shapes=e.shapes.filter(a(o)):e.shapes.push({brush:t.brush,orig:n,dest:r}),u(e)}function u(e){e.onChange&&e.onChange(e.shapes)}Object.defineProperty(r,"__esModule",{value:!0});var c=e("./board"),f=e("./util"),d=["green","red","blue","yellow"];r.start=function(e,t){if(!(t.touches&&t.touches.length>1)){t.stopPropagation(),t.preventDefault(),c.cancelMove(e);var r=f.eventPosition(t),o=c.getKeyAtDomPos(r,"white"===e.orientation,e.dom.bounds());o&&(e.drawable.current={orig:o,dest:o,pos:r,brush:i(t)},n(e))}},r.processDraw=n,r.move=function(e,t){e.drawable.current&&(e.drawable.current.pos=f.eventPosition(t))},r.end=function(e){var t=e.drawable.current;t&&(t.dest&&t.dest!==t.orig?l(e.drawable,t,t.dest):s(e.drawable,t),o(e))},r.cancel=o,r.clear=function(e){e.drawable.shapes.length&&(e.drawable.shapes=[],e.dom.redraw(),u(e.drawable))}},{"./board":5,"./util":18}],10:[function(e,t,r){"use strict";function n(e,t,r,n){return e.addEventListener(t,r,n),function(){return e.removeEventListener(t,r)}}function o(e){return function(t){e.draggable.current?a.cancel(e):e.drawable.current?s.cancel(e):t.shiftKey||l.isRightButton(t)?e.drawable.enabled&&s.start(e,t):e.viewOnly||a.start(e,t)}}function i(e,t,r){return function(n){n.shiftKey||l.isRightButton(n)?e.drawable.enabled&&r(e,n):e.viewOnly||t(e,n)}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("./drag"),s=e("./draw"),l=e("./util");r.bindBoard=function(e){var t=e.dom.elements.board;e.viewOnly||["touchstart","mousedown"].forEach(function(r){return t.addEventListener(r,o(e))}),(e.disableContextMenu||e.drawable.enabled)&&t.addEventListener("contextmenu",function(e){return e.preventDefault(),!1})},r.bindDocument=function(e,t){var r=i(e,a.move,s.move),o=i(e,a.end,s.end),u=[];e.viewOnly||(["touchmove","mousemove"].forEach(function(e){return u.push(n(document,e,r))}),["touchend","mouseup"].forEach(function(e){return u.push(n(document,e,o))}));e.resizable&&u.push(n(document.body,"chessground.resize",function(){e.dom.bounds.clear(),l.raf(t)}));var c=function(){return e.dom.bounds.clear()};return u.push(n(window,"scroll",c,{passive:!0})),u.push(n(window,"resize",c,{passive:!0})),function(){return u.forEach(function(e){return e()})}}},{"./drag":8,"./draw":9,"./util":18}],11:[function(e,t,r){"use strict";function n(e,t){e.exploding&&(t?e.exploding.stage=t:e.exploding=void 0,e.dom.redraw())}Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){e.exploding={stage:1,keys:t},e.dom.redraw(),setTimeout(function(){n(e,2),setTimeout(function(){return n(e,void 0)},120)},120)}},{}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./util"),o=e("./types");r.initial="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR";var i={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"},a={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"};r.read=function(e){"start"===e&&(e=r.initial);for(var t={},o=8,a=0,s=0,l=e;s<l.length;s++){var u=l[s];switch(u){case" ":return t;case"/":if(0==--o)return t;a=0;break;case"~":t[n.pos2key([a,o])].promoted=!0;break;default:var c=u.charCodeAt(0);if(c<57)a+=c-48;else{++a;var f=u.toLowerCase();t[n.pos2key([a,o])]={role:i[f],color:u===f?"black":"white"}}}}return t},r.write=function(e){var t,r;return n.invRanks.map(function(i){return o.ranks.map(function(o){return(t=e[n.pos2key([o,i])])?(r=a[t.role],"white"===t.color?r.toUpperCase():r):"1"}).join("")}).join("/").replace(/1{2,}/g,function(e){return e.length.toString()})}},{"./types":17,"./util":18}],13:[function(e,t,r){"use strict";function n(e,t){return Math.abs(e-t)}function o(e){return function(t,r,o,i){return n(t,o)<2&&("white"===e?i===r+1||r<=2&&i===r+2&&t===o:i===r-1||r>=7&&i===r-2&&t===o)}}function i(e,t,r){return function(o,i,a,l){return n(o,a)<2&&n(i,l)<2||r&&i===l&&i===("white"===e?1:8)&&(5===o&&(3===a||7===a)||s.containsX(t,a))}}function a(e,t){var r;return Object.keys(e).filter(function(n){return(r=e[n])&&r.color===t&&"rook"===r.role}).map(function(e){return s.key2pos(e)[0]})}Object.defineProperty(r,"__esModule",{value:!0});var s=e("./util"),l=function(e,t,r,o){var i=n(e,r),a=n(t,o);return 1===i&&2===a||2===i&&1===a},u=function(e,t,r,o){return n(e,r)===n(t,o)},c=function(e,t,r,n){return e===r||t===n},f=function(e,t,r,n){return u(e,t,r,n)||c(e,t,r,n)};r.default=function(e,t,r){var n,d=e[t],p=s.key2pos(t);switch(d.role){case"pawn":n=o(d.color);break;case"knight":n=l;break;case"bishop":n=u;break;case"rook":n=c;break;case"queen":n=f;break;case"king":n=i(d.color,a(e,d.color),r)}return s.allKeys.map(s.key2pos).filter(function(e){return(p[0]!==e[0]||p[1]!==e[1])&&n(p[0],p[1],e[0],e[1])}).map(s.pos2key)}},{"./util":18}],14:[function(e,t,r){"use strict";function n(e){return"PIECE"===e.tagName}function o(e){return"SQUARE"===e.tagName}function i(e,t){for(var r in t)e.dom.elements.board.removeChild(t[r])}function a(e,t,r){var n=d.createEl("square",t);return n.cgKey=e,n.style.transform=d.translate(r),n}function s(e,t,r,n,o,i){var a=u(t),s=d.createEl("piece",a),c=d.key2pos(r);s.cgPiece=a,s.cgKey=r;var f=d.posToTranslate(c,n,i);return o&&(s.cgAnimating=!0,f[0]+=o[1][0],f[1]+=o[1][1]),s.style.transform=d.translate(f),e.addPieceZIndex&&(s.style.zIndex=l(c,n)),s}function l(e,t){var r=2+8*(e[1]-1)+(8-e[0]);return t&&(r=67-r),r+""}function u(e){return e.color+" "+e.role}function c(e){var t,r,n={};if(e.lastMove&&e.highlight.lastMove)for(t in e.lastMove)f(n,e.lastMove[t],"last-move");if(e.check&&e.highlight.check&&f(n,e.check,"check"),e.selected&&(f(n,e.selected,"selected"),e.movable.showDests)){var o=e.movable.dests&&e.movable.dests[e.selected];if(o)for(t in o)f(n,r=o[t],"move-dest"+(e.pieces[r]?" oc":""));var i=e.premovable.dests;if(i)for(t in i)f(n,r=i[t],"premove-dest"+(e.pieces[r]?" oc":""))}var a=e.premovable.current;if(a)for(t in a)f(n,a[t],"current-premove");else e.predroppable.current&&f(n,e.predroppable.current.key,"current-premove");var s=e.exploding;if(s)for(t in s.keys)f(n,s.keys[t],"exploding"+s.stage);return n}function f(e,t,r){e[t]?e[t]+=" "+r:e[t]=r}Object.defineProperty(r,"__esModule",{value:!0});var d=e("./util");r.default=function(e){var t,r,f,p,v,h,g,m,b,y,w,k,P="white"===e.orientation,E=e.dom.bounds(),C=e.dom.elements.board,_=e.pieces,A=e.animation.current,O=A?A.plan.anims:{},S=A?A.plan.fadings:{},T=e.draggable.current,x=c(e),M={},N={},L={},D={},I=Object.keys(_);for(f=C.firstChild;f;){if(t=f.cgKey,n(f))p=_[t],g=O[t],m=S[t],v=f.cgPiece,!f.cgDragging||T&&T.orig===t||(f.classList.remove("dragging"),f.style.transform=d.translate(d.posToTranslate(d.key2pos(t),P,E)),f.cgDragging=!1),!m&&f.cgFading&&(f.cgFading=!1,f.classList.remove("fading")),p?(g&&f.cgAnimating&&v===u(p)?((h=d.posToTranslate(d.key2pos(t),P,E))[0]+=g[1][0],h[1]+=g[1][1],f.style.transform=d.translate(h),f.classList.add("anim")):f.cgAnimating&&(f.style.transform=d.translate(d.posToTranslate(d.key2pos(t),P,E)),f.cgAnimating=!1,f.classList.remove("anim")),v!==u(p)||m&&f.cgFading?m&&v===u(m)?(f.classList.add("fading"),f.cgFading=!0):L[v]?L[v].push(f):L[v]=[f]:M[t]=!0):L[v]?L[v].push(f):L[v]=[f];else if(o(f)){var K=f.className;x[t]===K?N[t]=!0:D[K]?D[K].push(f):D[K]=[f]}f=f.nextSibling}for(var j in x)N[j]||(k=(w=D[x[j]])&&w.pop(),h=d.posToTranslate(d.key2pos(j),P,E),k?(k.cgKey=j,k.style.transform=d.translate(h)):C.insertBefore(a(j,x[j],h),C.firstChild));for(var q in I)if(t=I[q],r=_[t],g=O[t],!M[t])if(b=L[u(r)],y=b&&b.pop()){y.cgKey=t,y.cgFading&&(y.classList.remove("fading"),y.cgFading=!1);var R=d.key2pos(t);e.addPieceZIndex&&(y.style.zIndex=l(R,P)),h=d.posToTranslate(R,P,E),g&&(y.cgAnimating=!0,y.classList.add("anim"),h[0]+=g[1][0],h[1]+=g[1][1]),y.style.transform=d.translate(h)}else C.appendChild(s(e,r,t,P,g,E));for(var U in L)i(e,L[U]);for(var U in D)i(e,D[U])}},{"./util":18}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./fen"),o=e("./util");r.defaults=function(){return{pieces:n.read(n.initial),orientation:"white",turnColor:"white",coordinates:!0,autoCastle:!0,viewOnly:!1,disableContextMenu:!1,resizable:!0,addPieceZIndex:!1,pieceKey:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{}},predroppable:{enabled:!1,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,centerPiece:!0,showGhost:!0,deleteOnDropOff:!1},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15}},pieces:{baseUrl:"https://lichess1.org/assets/piece/cburnett/"}},hold:o.timer()}}},{"./fen":12,"./util":18}],16:[function(e,t,r){"use strict";function n(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function o(e,t,r){var n,o={};t.forEach(function(t){t.shape.dest&&(n=e.brushes[t.shape.brush],t.shape.modifiers&&(n=g(n,t.shape.modifiers)),o[n.key]=n)});for(var i={},a=r.firstChild;a;)i[a.getAttribute("cgKey")]=!0,a=a.nextSibling;for(var s in o)i[s]||r.appendChild(p(o[s]))}function i(e,t,r,n,o){void 0===E&&(E=P.computeIsTrident());var i=e.dom.bounds(),a={},s=[];t.forEach(function(e){a[e.hash]=!1});for(var l,c=o.nextSibling;c;)l=c.getAttribute("cgHash"),a.hasOwnProperty(l)?a[l]=!0:s.push(c),c=c.nextSibling;s.forEach(function(e){return n.removeChild(e)}),t.forEach(function(t){a[t.hash]||n.appendChild(u(e,t,r,i))})}function a(e,t){var r=e.orig,n=e.dest,o=e.brush,i=e.piece,a=e.modifiers;return[t,r,n,o,i&&s(i),a&&l(a)].filter(function(e){return e}).join("")}function s(e){return[e.color,e.role,e.scale].filter(function(e){return e}).join("")}function l(e){return""+(e.lineWidth||"")}function u(e,t,r,n){var o,i=t.shape,a=t.current,s=t.hash;if(i.piece)o=d(e.drawable.pieces.baseUrl,h(P.key2pos(i.orig),e.orientation),i.piece,n);else{var l=h(P.key2pos(i.orig),e.orientation);if(i.orig&&i.dest){var u=r[i.brush];i.modifiers&&(u=g(u,i.modifiers)),o=f(u,l,h(P.key2pos(i.dest),e.orientation),a,n)}else o=c(r[i.brush],l,a,n)}return o.setAttribute("cgHash",s),o}function c(e,t,r,o){var i=k(t,o),a=m(r,o),s=(o.width+o.height)/32;return v(n("circle"),{stroke:e.color,"stroke-width":a,fill:"none",opacity:y(e,r),cx:i[0],cy:i[1],r:s-a/2})}function f(e,t,r,o,i){var a=w(i,o),s=k(t,i),l=k(r,i),u=l[0]-s[0],c=l[1]-s[1],f=Math.atan2(c,u),d=Math.cos(f)*a,p=Math.sin(f)*a;return v(n("line"),{stroke:e.color,"stroke-width":b(e,o,i),"stroke-linecap":"round","marker-end":E?void 0:"url(#arrowhead-"+e.key+")",opacity:y(e,o),x1:s[0],y1:s[1],x2:l[0]-d,y2:l[1]-p})}function d(e,t,r,o){var i=k(t,o),a=o.width/8*(r.scale||1),s=r.color[0]+("knight"===r.role?"n":r.role[0]).toUpperCase();return v(n("image"),{className:r.role+" "+r.color,x:i[0]-a/2,y:i[1]-a/2,width:a,height:a,href:e+s+".svg"})}function p(e){var t=v(n("marker"),{id:"arrowhead-"+e.key,orient:"auto",markerWidth:4,markerHeight:8,refX:2.05,refY:2.01});return t.appendChild(v(n("path"),{d:"M0,0 V4 L3,2 Z",fill:e.color})),t.setAttribute("cgKey",e.key),t}function v(e,t){for(var r in t)e.setAttribute(r,t[r]);return e}function h(e,t){return"white"===t?e:[9-e[0],9-e[1]]}function g(e,t){var r={color:e.color,opacity:Math.round(10*e.opacity)/10,lineWidth:Math.round(t.lineWidth||e.lineWidth)};return r.key=[e.key,t.lineWidth].filter(function(e){return e}).join(""),r}function m(e,t){return(e?3:4)/512*t.width}function b(e,t,r){return(e.lineWidth||10)*(t?.85:1)/512*r.width}function y(e,t){return(e.opacity||1)*(t?.9:1)}function w(e,t){return E?0:(t?10:20)/512*e.width}function k(e,t){return[(e[0]-.5)*t.width/8,(8.5-e[1])*t.height/8]}Object.defineProperty(r,"__esModule",{value:!0});var P=e("./util");r.createElement=n;var E,C="";r.clearCache=function(){C=""},r.renderSvg=function(e,t){var r=e.drawable,n=r.shapes.concat(r.autoShapes).map(function(e){return{shape:e,current:!1,hash:a(e,!1)}});r.current&&n.push({shape:r.current,current:!0,hash:a(r.current,!0)});var s=n.map(function(e){return e.hash}).join("");if(s!==C){C=s;var l=t.firstChild;o(r,n,l),i(e,n,r.brushes,t,l)}}},{"./util":18}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.files=["a","b","c","d","e","f","g","h"],r.ranks=[1,2,3,4,5,6,7,8]},{}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./types");r.colors=["white","black"],r.invRanks=[8,7,6,5,4,3,2,1],r.allKeys=(o=Array.prototype).concat.apply(o,n.files.map(function(e){return n.ranks.map(function(t){return e+t})})),r.pos2key=function(e){return r.allKeys[8*e[0]+e[1]-9]},r.key2pos=function(e){return[e.charCodeAt(0)-96,e.charCodeAt(1)-48]},r.memo=function(e){var t,r=function(){return void 0===t&&(t=e()),t};return r.clear=function(){t=void 0},r},r.timer=function(){var e;return{start:function(){e=new Date},cancel:function(){e=void 0},stop:function(){if(!e)return 0;var t=Date.now()-e.getTime();return e=void 0,t}}},r.opposite=function(e){return"white"===e?"black":"white"},r.containsX=function(e,t){return!!e&&-1!==e.indexOf(t)},r.distanceSq=function(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)},r.samePiece=function(e,t){return e.role===t.role&&e.color===t.color},r.computeIsTrident=function(){return window.navigator.userAgent.indexOf("Trident/")>-1},r.posToTranslate=function(e,t,r){return[(t?e[0]-1:8-e[0])*r.width/8,(t?8-e[1]:e[1]-1)*r.height/8]},r.translate=function(e){return"translate("+e[0]+"px,"+e[1]+"px)"},r.translateAway=r.translate([-99999,-99999]),r.eventPosition=function(e){return e.clientX||0===e.clientX?[e.clientX,e.clientY]:e.touches&&e.targetTouches[0]?[e.targetTouches[0].clientX,e.targetTouches[0].clientY]:void 0},r.isRightButton=function(e){return 2===e.buttons||2===e.button},r.createEl=function(e,t){var r=document.createElement(e);return t&&(r.className=t),r},r.raf=(window.requestAnimationFrame||window.setTimeout).bind(window);var o},{"./types":17}],19:[function(e,t,r){"use strict";function n(e,t){var r,n=o.createEl("coords",t);for(var i in e)(r=o.createEl("coord")).textContent=e[i],n.appendChild(r);return n}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./util"),i=e("./types"),a=e("./svg");r.default=function(e,t,r){e.innerHTML="",e.classList.add("cg-board-wrap"),o.colors.forEach(function(r){e.classList.toggle("orientation-"+r,t.orientation===r)}),e.classList.toggle("manipulable",!t.viewOnly);var s=o.createEl("div","cg-board");e.appendChild(s);var l;if(t.drawable.enabled&&((l=a.createElement("svg")).appendChild(a.createElement("defs")),e.appendChild(l)),t.coordinates){var u="black"===t.orientation?" black":"";e.appendChild(n(i.ranks,"ranks"+u)),e.appendChild(n(i.files,"files"+u))}var c;t.viewOnly||!t.movable.showDests&&!t.premovable.showDests||((c=o.createEl("div","over")).style.transform=o.translateAway,c.style.width=r.width/8+"px",c.style.height=r.height/8+"px",e.appendChild(c));var f;return!t.viewOnly&&t.draggable.showGhost&&((f=o.createEl("piece","ghost")).style.transform=o.translateAway,e.appendChild(f)),{board:s,over:c,ghost:f,svg:l}}},{"./svg":16,"./types":17,"./util":18}],20:[function(e,t,r){"use strict";function n(e,t,r){if(e.ns="http://www.w3.org/2000/svg","foreignObject"!==r&&void 0!==t)for(var o=0;o<t.length;++o){var i=t[o].data;void 0!==i&&n(i,t[o].children,t[o].sel)}}function o(e,t,r){var o,s,l,u={};if(void 0!==r?(u=t,a.array(r)?o=r:a.primitive(r)?s=r:r&&r.sel&&(o=[r])):void 0!==t&&(a.array(t)?o=t:a.primitive(t)?s=t:t&&t.sel?o=[t]:u=t),a.array(o))for(l=0;l<o.length;++l)a.primitive(o[l])&&(o[l]=i.vnode(void 0,void 0,void 0,o[l]));return"s"!==e[0]||"v"!==e[1]||"g"!==e[2]||3!==e.length&&"."!==e[3]&&"#"!==e[3]||n(u,o,e),i.vnode(e,u,o,s,void 0)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("./vnode"),a=e("./is");r.h=o,r.default=o},{"./is":22,"./vnode":29}],21:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.htmlDomApi={createElement:function(e){return document.createElement(e)},createElementNS:function(e,t){return document.createElementNS(e,t)},createTextNode:function(e){return document.createTextNode(e)},createComment:function(e){return document.createComment(e)},insertBefore:function(e,t,r){e.insertBefore(t,r)},removeChild:function(e,t){e.removeChild(t)},appendChild:function(e,t){e.appendChild(t)},parentNode:function(e){return e.parentNode},nextSibling:function(e){return e.nextSibling},tagName:function(e){return e.tagName},setTextContent:function(e,t){e.textContent=t},getTextContent:function(e){return e.textContent},isElement:function(e){return 1===e.nodeType},isText:function(e){return 3===e.nodeType},isComment:function(e){return 8===e.nodeType}},r.default=r.htmlDomApi},{}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.array=Array.isArray,r.primitive=function(e){return"string"==typeof e||"number"==typeof e}},{}],23:[function(e,t,r){"use strict";function n(e,t){var r,n=t.elm,o=e.data.attrs,c=t.data.attrs;if((o||c)&&o!==c){o=o||{},c=c||{};for(r in c){var f=c[r];o[r]!==f&&(u[r]?f?n.setAttribute(r,""):n.removeAttribute(r):r.charCodeAt(0)!==l?n.setAttribute(r,f):r.charCodeAt(3)===s?n.setAttributeNS(a,r,f):r.charCodeAt(5)===s?n.setAttributeNS(i,r,f):n.setAttribute(r,f))}for(r in o)r in c||n.removeAttribute(r)}}Object.defineProperty(r,"__esModule",{value:!0});for(var o=["allowfullscreen","async","autofocus","autoplay","checked","compact","controls","declare","default","defaultchecked","defaultmuted","defaultselected","defer","disabled","draggable","enabled","formnovalidate","hidden","indeterminate","inert","ismap","itemscope","loop","multiple","muted","nohref","noresize","noshade","novalidate","nowrap","open","pauseonexit","readonly","required","reversed","scoped","seamless","selected","sortable","spellcheck","translate","truespeed","typemustmatch","visible"],i="http://www.w3.org/1999/xlink",a="http://www.w3.org/XML/1998/namespace",s=58,l=120,u=Object.create(null),c=0,f=o.length;c<f;c++)u[o[c]]=!0;r.attributesModule={create:n,update:n},r.default=r.attributesModule},{}],24:[function(e,t,r){"use strict";function n(e,t){var r,n,o=t.elm,i=e.data.class,a=t.data.class;if((i||a)&&i!==a){i=i||{},a=a||{};for(n in i)a[n]||o.classList.remove(n);for(n in a)(r=a[n])!==i[n]&&o.classList[r?"add":"remove"](n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.classModule={create:n,update:n},r.default=r.classModule},{}],25:[function(e,t,r){"use strict";function n(e,t,r){if("function"==typeof e)e.call(t,r,t);else if("object"==typeof e)if("function"==typeof e[0])if(2===e.length)e[0].call(t,e[1],r,t);else{var o=e.slice(1);o.push(r),o.push(t),e[0].apply(t,o)}else for(var i=0;i<e.length;i++)n(e[i])}function o(e,t){var r=e.type,o=t.data.on;o&&o[r]&&n(o[r],t,e)}function i(){return function e(t){o(t,e.vnode)}}function a(e,t){var r,n=e.data.on,o=e.listener,a=e.elm,s=t&&t.data.on,l=t&&t.elm;if(n!==s){if(n&&o)if(s)for(r in n)s[r]||a.removeEventListener(r,o,!1);else for(r in n)a.removeEventListener(r,o,!1);if(s){var u=t.listener=e.listener||i();if(u.vnode=t,n)for(r in s)n[r]||l.addEventListener(r,u,!1);else for(r in s)l.addEventListener(r,u,!1)}}}Object.defineProperty(r,"__esModule",{value:!0}),r.eventListenersModule={create:a,update:a,destroy:a},r.default=r.eventListenersModule},{}],26:[function(e,t,r){"use strict";function n(e,t,r){a(function(){e[t]=r})}function o(e,t){var r,o,i=t.elm,a=e.data.style,s=t.data.style;if((a||s)&&a!==s){a=a||{},s=s||{};var l="delayed"in a;for(o in a)s[o]||("-"===o[0]&&"-"===o[1]?i.style.removeProperty(o):i.style[o]="");for(o in s)if(r=s[o],"delayed"===o&&s.delayed)for(var u in s.delayed)r=s.delayed[u],l&&r===a.delayed[u]||n(i.style,u,r);else"remove"!==o&&r!==a[o]&&("-"===o[0]&&"-"===o[1]?i.style.setProperty(o,r):i.style[o]=r)}}Object.defineProperty(r,"__esModule",{value:!0});var i="undefined"!=typeof window&&window.requestAnimationFrame||setTimeout,a=function(e){i(function(){i(e)})};r.styleModule={create:o,update:o,destroy:function(e){var t,r,n=e.elm,o=e.data.style;if(o&&(t=o.destroy))for(r in t)n.style[r]=t[r]},remove:function(e,t){var r=e.data.style;if(r&&r.remove){var n,o,i=e.elm,a=0,s=r.remove,l=0,u=[];for(n in s)u.push(n),i.style[n]=s[n];for(var c=(o=getComputedStyle(i))["transition-property"].split(", ");a<c.length;++a)-1!==u.indexOf(c[a])&&l++;i.addEventListener("transitionend",function(e){e.target===i&&--l,0===l&&t()})}else t()}},r.default=r.styleModule},{}],27:[function(e,t,r){"use strict";function n(e){return void 0===e}function o(e){return void 0!==e}function i(e,t){return e.key===t.key&&e.sel===t.sel}function a(e){return void 0!==e.sel}function s(e,t,r){var n,o,i,a={};for(n=t;n<=r;++n)null!=(i=e[n])&&void 0!==(o=i.key)&&(a[o]=n);return a}Object.defineProperty(r,"__esModule",{value:!0});var l=e("./vnode"),u=e("./is"),c=e("./htmldomapi"),f=l.default("",{},[],void 0,void 0),d=["create","update","remove","destroy","pre","post"],p=e("./h");r.h=p.h;var v=e("./thunk");r.thunk=v.thunk,r.init=function(e,t){function r(e){var t=e.id?"#"+e.id:"",r=e.className?"."+e.className.split(" ").join("."):"";return l.default(E.tagName(e).toLowerCase()+t+r,{},[],void 0,e)}function p(e,t){return function(){if(0==--t){var r=E.parentNode(e);E.removeChild(r,e)}}}function v(e,t){var r,i=e.data;void 0!==i&&o(r=i.hook)&&o(r=r.init)&&(r(e),i=e.data);var a=e.children,s=e.sel;if("!"===s)n(e.text)&&(e.text=""),e.elm=E.createComment(e.text);else if(void 0!==s){var l=s.indexOf("#"),c=s.indexOf(".",l),d=l>0?l:s.length,p=c>0?c:s.length,h=-1!==l||-1!==c?s.slice(0,Math.min(d,p)):s,g=e.elm=o(i)&&o(r=i.ns)?E.createElementNS(r,h):E.createElement(h);for(d<p&&g.setAttribute("id",s.slice(d+1,p)),c>0&&g.setAttribute("class",s.slice(p+1).replace(/\./g," ")),r=0;r<P.create.length;++r)P.create[r](f,e);if(u.array(a))for(r=0;r<a.length;++r){var m=a[r];null!=m&&E.appendChild(g,v(m,t))}else u.primitive(e.text)&&E.appendChild(g,E.createTextNode(e.text));o(r=e.data.hook)&&(r.create&&r.create(f,e),r.insert&&t.push(e))}else e.elm=E.createTextNode(e.text);return e.elm}function h(e,t,r,n,o,i){for(;n<=o;++n){var a=r[n];null!=a&&E.insertBefore(e,v(a,i),t)}}function g(e){var t,r,n=e.data;if(void 0!==n){for(o(t=n.hook)&&o(t=t.destroy)&&t(e),t=0;t<P.destroy.length;++t)P.destroy[t](e);if(void 0!==e.children)for(r=0;r<e.children.length;++r)null!=(t=e.children[r])&&"string"!=typeof t&&g(t)}}function m(e,t,r,n){for(;r<=n;++r){var i=void 0,a=void 0,s=void 0,l=t[r];if(null!=l)if(o(l.sel)){for(g(l),a=P.remove.length+1,s=p(l.elm,a),i=0;i<P.remove.length;++i)P.remove[i](l,s);o(i=l.data)&&o(i=i.hook)&&o(i=i.remove)?i(l,s):s()}else E.removeChild(e,l.elm)}}function b(e,t,r,o){for(var a,l,u,c=0,f=0,d=t.length-1,p=t[0],g=t[d],b=r.length-1,w=r[0],k=r[b];c<=d&&f<=b;)null==p?p=t[++c]:null==g?g=t[--d]:null==w?w=r[++f]:null==k?k=r[--b]:i(p,w)?(y(p,w,o),p=t[++c],w=r[++f]):i(g,k)?(y(g,k,o),g=t[--d],k=r[--b]):i(p,k)?(y(p,k,o),E.insertBefore(e,p.elm,E.nextSibling(g.elm)),p=t[++c],k=r[--b]):i(g,w)?(y(g,w,o),E.insertBefore(e,g.elm,p.elm),g=t[--d],w=r[++f]):(void 0===a&&(a=s(t,c,d)),n(l=a[w.key])?(E.insertBefore(e,v(w,o),p.elm),w=r[++f]):((u=t[l]).sel!==w.sel?E.insertBefore(e,v(w,o),p.elm):(y(u,w,o),t[l]=void 0,E.insertBefore(e,u.elm,p.elm)),w=r[++f]));c>d?h(e,null==r[b+1]?null:r[b+1].elm,r,f,b,o):f>b&&m(e,t,c,d)}function y(e,t,r){var i,a;o(i=t.data)&&o(a=i.hook)&&o(i=a.prepatch)&&i(e,t);var s=t.elm=e.elm,l=e.children,u=t.children;if(e!==t){if(void 0!==t.data){for(i=0;i<P.update.length;++i)P.update[i](e,t);o(i=t.data.hook)&&o(i=i.update)&&i(e,t)}n(t.text)?o(l)&&o(u)?l!==u&&b(s,l,u,r):o(u)?(o(e.text)&&E.setTextContent(s,""),h(s,null,u,0,u.length-1,r)):o(l)?m(s,l,0,l.length-1):o(e.text)&&E.setTextContent(s,""):e.text!==t.text&&E.setTextContent(s,t.text),o(a)&&o(i=a.postpatch)&&i(e,t)}}var w,k,P={},E=void 0!==t?t:c.default;for(w=0;w<d.length;++w)for(P[d[w]]=[],k=0;k<e.length;++k){var C=e[k][d[w]];void 0!==C&&P[d[w]].push(C)}return function(e,t){var n,o,s,l=[];for(n=0;n<P.pre.length;++n)P.pre[n]();for(a(e)||(e=r(e)),i(e,t)?y(e,t,l):(o=e.elm,s=E.parentNode(o),v(t,l),null!==s&&(E.insertBefore(s,t.elm,E.nextSibling(o)),m(s,[e],0,0))),n=0;n<l.length;++n)l[n].data.hook.insert(l[n]);for(n=0;n<P.post.length;++n)P.post[n]();return t}}},{"./h":20,"./htmldomapi":21,"./is":22,"./thunk":28,"./vnode":29}],28:[function(e,t,r){"use strict";function n(e,t){t.elm=e.elm,e.data.fn=t.data.fn,e.data.args=t.data.args,t.data=e.data,t.children=e.children,t.text=e.text,t.elm=e.elm}function o(e){var t=e.data;n(t.fn.apply(void 0,t.args),e)}function i(e,t){var r,o=e.data,i=t.data,a=o.args,s=i.args;if(o.fn===i.fn&&a.length===s.length){for(r=0;r<s.length;++r)if(a[r]!==s[r])return void n(i.fn.apply(void 0,s),t);n(e,t)}else n(i.fn.apply(void 0,s),t)}Object.defineProperty(r,"__esModule",{value:!0});var a=e("./h");r.thunk=function(e,t,r,n){return void 0===n&&(n=r,r=t,t=void 0),a.h(e,{key:t,hook:{init:o,prepatch:i},fn:r,args:n})},r.default=r.thunk},{"./h":20}],29:[function(e,t,r){"use strict";function n(e,t,r,n,o){return{sel:e,data:t,children:r,text:n,elm:o,key:void 0===t?void 0:t.key}}Object.defineProperty(r,"__esModule",{value:!0}),r.vnode=n,r.default=n},{}],30:[function(e,t,r){"use strict";function n(e,t){function r(){var t=p(e.history(),2).map(function(e,t){var r=e[0],n=e[1];return a.h("tr",[a.h("th",t+1),a.h("td",r),a.h("td",n||"...")])});return a.h("table",t)}var n,o=a.init([u.default,c.default,f.default,d.default]);return function(){n=o(n||t,r())}}function o(e){var t={};return e.SQUARES.forEach(function(r){var n=e.moves({square:r,verbose:!0});n.length&&(t[r]=n.map(function(e){return e.to}))}),t}function i(e,t,r){return function(n,i){t.move({from:n,to:i});var a="w"===t.turn()?"white":"black";e.set({turnColor:a,movable:{color:a,dests:o(t)},viewOnly:!1}),e.state.stats.dragged?setTimeout(e.toggleOrientation,100):setTimeout(e.toggleOrientation,1e3),r()}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("snabbdom"),s=e("chess.js"),l=e("chessground"),u=e("snabbdom/modules/class"),c=e("snabbdom/modules/attributes"),f=e("snabbdom/modules/eventlisteners"),d=e("snabbdom/modules/style"),p=e("array.chunk");r.run=function(e,t){function r(){g=y(g||e,v())}function p(e){if(h)h.redrawAll();else{var t=e.elm;(h=l.Chessground(t,{animation:{duration:1e3},movable:{color:"white",free:!1,dests:o(w)}})).set({movable:{events:{after:i(h,w,b)}}}),window.cg=h}}function v(){var t=m.clientHeight,r=e.clientWidth;return null!=t&&e.clientWidth>t&&(r=t-16),a.h("div#crowdchess",a.h("div.blue.merida",a.h("div.cg-board-wrap",{style:{width:r+"px",height:r+"px"},hook:{insert:p,postpatch:p}})))}var h,g,m,b,y=a.init([u.default,c.default,f.default,d.default]),w=new s.Chess;return m=t.parentElement.parentElement,b=n(w,t),r(),r}},{"array.chunk":1,"chess.js":2,chessground:6,snabbdom:27,"snabbdom/modules/attributes":23,"snabbdom/modules/class":24,"snabbdom/modules/eventlisteners":25,"snabbdom/modules/style":26}]},{},[30])(30)});